<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add correlation of anchor signals to pairs of close genomic regions. — addCovCor • sevenC</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add correlation of anchor signals to pairs of close genomic regions. — addCovCor"><meta property="og:description" content="This function adds a vector with correlation values for each input
interaction. Only works for input interaction within the given maxDist
distance. Note, this function does not work on windows because reading of
bigWig files is currently not supported on windows."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sevenC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sevenC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ibn-salem/sevenC" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add correlation of anchor signals to pairs of close genomic regions.</h1>
    <small class="dont-index">Source: <a href="https://github.com/ibn-salem/sevenC/blob/devel/R/interaction.R" class="external-link"><code>R/interaction.R</code></a></small>
    <div class="hidden name"><code>addCovCor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function adds a vector with correlation values for each input
interaction. Only works for input interaction within the given <code>maxDist</code>
distance. Note, this function does not work on windows because reading of
bigWig files is currently not supported on windows.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addCovCor</span><span class="op">(</span></span>
<span>  <span class="va">gi</span>,</span>
<span>  datacol <span class="op">=</span> <span class="st">"chip"</span>,</span>
<span>  colname <span class="op">=</span> <span class="st">"cor_chip"</span>,</span>
<span>  maxDist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use <span class="op">=</span> <span class="st">"everything"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pearson"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-gi">gi<a class="anchor" aria-label="anchor" href="#arg-gi"></a></dt>
<dd><p>A sorted <code><a href="https://rdrr.io/pkg/InteractionSet/man/InteractionSet-class.html" class="external-link">GInteractions</a></code> object.</p></dd>


<dt id="arg-datacol">datacol<a class="anchor" aria-label="anchor" href="#arg-datacol"></a></dt>
<dd><p>a string matching an annotation column in <code>regions(gi)</code>.
This column is assumed to hold the same number of values for each
interaction as a <code>NumericList</code>.</p></dd>


<dt id="arg-colname">colname<a class="anchor" aria-label="anchor" href="#arg-colname"></a></dt>
<dd><p>A string that is used as columnname for the new column in
<code>gi</code>.</p></dd>


<dt id="arg-maxdist">maxDist<a class="anchor" aria-label="anchor" href="#arg-maxdist"></a></dt>
<dd><p>maximal distance of pairs in bp as numeric. If maxDist=NULL,
the maximal distance is computed from input interactions gi by
<code>max(pairdist(gi))</code>.</p></dd>


<dt id="arg-use">use<a class="anchor" aria-label="anchor" href="#arg-use"></a></dt>
<dd><p>an optional character string giving a method for computing
covariances in the presence of missing values. See <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>
for more details.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a character string indicating which correlation coefficient (or
covariance) is to be computed. One of "pearson" (default), "kendall", or
"spearman": can be abbreviated. See <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code> for more
details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="https://rdrr.io/pkg/InteractionSet/man/InteractionSet-class.html" class="external-link">GInteractions</a></code> similar to <code>gi</code>
 just with an additional column added.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">!=</span> <span class="st">"windows"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># use internal motif data on chromosome 22</span></span></span>
<span class="r-in"><span>  <span class="va">motifGR</span> <span class="op">&lt;-</span> <span class="fu">sevenC</span><span class="fu">::</span><span class="va"><a href="motif.hg19.CTCF.chr22.html">motif.hg19.CTCF.chr22</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># use example bigWig file</span></span></span>
<span class="r-in"><span> <span class="va">exampleBigWig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>     <span class="st">"GM12878_Stat1.chr22_1-30000000.bigWig"</span>, package <span class="op">=</span> <span class="st">"sevenC"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># add coverage from bigWig file</span></span></span>
<span class="r-in"><span>  <span class="va">motifGR</span> <span class="op">&lt;-</span> <span class="fu"><a href="addCovToGR.html">addCovToGR</a></span><span class="op">(</span><span class="va">motifGR</span>, <span class="va">exampleBigWig</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># get all pairs within 1Mb</span></span></span>
<span class="r-in"><span>  <span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu"><a href="getCisPairs.html">getCisPairs</a></span><span class="op">(</span><span class="va">motifGR</span>, <span class="fl">1e5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># compute correaltion of coverge for each pair</span></span></span>
<span class="r-in"><span>  <span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu">addCovCor</span><span class="op">(</span><span class="va">gi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># addCovCor adds a new metadata column:</span></span></span>
<span class="r-in"><span>  <span class="fu">mcols</span><span class="op">(</span><span class="va">gi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2808 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           dist  cor_chip</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;integer&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        19119  0.339540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        52360 -0.104692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        53000  0.885073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        53639 -0.170961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        61058 -0.104692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...        ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2804     49248        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2805     61304        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2806     29898        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2807     41954        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2808     12056        NA</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jonas Ibn-Salem.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

      </footer></div>






  </body></html>

